#  /opt/entropywatcher/os.env *
# EntropyWatcher-Scan für Betriebssystem-Pfade

#Label
SOURCE_LABEL=os

# OS-Pfade für Entropy-Scan (OHNE /boot - siehe common.env EXCLUDES)
# /boot wird bewusst ausgelassen: Kernel/initrd sind komprimiert → False-Positives
# Ransomware würde /boot nicht verschlüsseln (System wäre unbootbar)
SCAN_PATHS="/usr/local,/opt,/var/www"

# EXCLUDES: Nutzt automatisch common.env EXCLUDES!
# (Dort sind .git/objects, /boot/*, av-quarantine, etc. bereits definiert)
# 
# Option A: Keine EXCLUDES hier (empfohlen, nutzt common.env)
# Option B: Kombinierte EXCLUDES (falls Symlinks zu /proc, /sys existieren):
# EXCLUDES_MODE=glob
# EXCLUDES="*/.git/objects/*,*/.git/logs/*,/boot/*,*/av-quarantine/*,*/.Spotlight-V100/*,*/node_modules/*,*/__pycache__/*,*.gz,*.xz,*.zip,*.tar,/proc/*,/sys/*,/dev/*,/run/*,/tmp/*,/var/tmp/*,/var/cache/*,/var/log/*"


# Dinge messen, aber nicht fürs Scoring werten (reduziert False Positives)
SCORE_EXCLUDES_MODE=glob
SCORE_EXCLUDES="*.sqlite,*.db,*.bin,*.npy,*/.cache/*,*/.venv/*,*/node_modules/*,*/__pycache__/*"

# Mail Parameter
MAIL_FROM=<YOUR_EMAIL>
MAIL_SUBJECT_PREFIX="[OS-EntropyWatcher]"

#Mail Rate-Limit File
ALERT_STATE_FILE="/var/lib/entropywatcher/last_alert_os.txt"

# os.env (täglich um 03:40)
HEALTH_WINDOW_MIN=1560  # 26 Stunden (24h + 2h Puffer)
